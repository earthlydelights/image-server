source 
5

+-----+    
|01234|    
|56789|    
|ABCDE|    
|FGHIJ|    
|KLMNO|    
+-----+    
           
targets               
2                                   3                                    4
+--+ +--+ +--+ +--+                 +---+ +---+ +---+                    +----+ +----+ 
|01| |12| |23| |34|                 |012| |123| |234|                    |0123| |1234| 
|56| |67| |78| |89|                 |567| |678| |789|                    |5678| |6789| 
+--+ +--+ +--+ +--+                 |ABC| |BCD| |CDE|                    |ABCD| |BCDE| 
                                    +---+ +---+ +---+                    |FGHI| |GHIJ| 
+--+ +--+ +--+ +--+                                                      +----+ +----+ 
|56| |67| |78| |89|                 +---+ +---+ +---+                                  
|AB| |BC| |CD| |DE|                 |567| |678| |789|                    +----+ +----+ 
+--+ +--+ +--+ +--+                 |ABC| |BCD| |CDE|                    |5678| |6789| 
                                    |FGH| |GHI| |HIJ|                    |ABCD| |BCDE| 
+--+ +--+ +--+ +--+                 +---+ +---+ +---+                    |FGHI| |GHIJ| 
|AB| |BC| |CD| |DE|                                                      |KLMN| |LMNO| 
|FG| |GH| |HI| |IJ|                 +---+ +---+ +---+                    +----+ +----+ 
+--+ +--+ +--+ +--+                 |ABC| |BCD| |CDE|  
                                    |FGH| |GHI| |HIJ|  
+--+ +--+ +--+ +--+                 |KLM| |LMN| |MNO|  
|FG| |GH| |HI| |IJ|                 +---+ +---+ +---+  
|KL| |LM| |MN| |NO|            
+--+ +--+ +--+ +--+            
                  
occurences                       
+-----+                             +-----+                              +-----+
|12221|                             |12321|                              |12221|
|24442|                             |24642|                              |24442|
|24442|                             |36963|                              |24442|
|24442|                             |24642|                              |24442|
|12221|                             |12321|                              |12221|
+-----+                             +-----+                              +-----+

+--+   +--+   +--+   +--+           +---+    +---+    +---+              +----+       +----+      
|12|   |22|   |22|   |21|           |123|    |232|    |321|              |1222|       |2221|       
|24|   |44|   |44|   |42|           |246|    |464|    |642|              |2444|       |4442|       
+--+9  +--+12 +--+12 +--+9          |369|    |696|    |963|              |2444|       |4442|       
                                    +---+36  +---+42  +---+36            |2444|       |4442|        
+--+   +--+   +--+   +--+                                                +----+49     +----+49       
|24|   |44|   |44|   |42|           +---+    +---+    +---+                                        
|24|   |44|   |44|   |42|           |246|    |464|    |642|              +----+       +----+       
+--+12 +--+16 +--+16 +--+12         |369|    |696|    |963|              |2444|       |4442|        
                                    |246|    |464|    |642|              |2444|       |4442|       
+--+   +--+   +--+   +--+           +---+42  +---+49  +---+42            |2444|       |4442|        
|24|   |44|   |44|   |42|                                                |1222|       |2221|                   
|24|   |44|   |44|   |42|           +---+    +---+    +---+              +----+49     +----+49    
+--+12 +--+16 +--+16 +--+12         |369|    |696|    |963|                            
                                    |246|    |464|    |642|                    
+--+   +--+   +--+   +--+           |123|    |232|    |321|                     
|24|   |44|   |44|   |42|           +---+36  +---+42  +---+36                    
|12|   |22|   |22|   |21|                                                        
+--+9  +--+12 +--+12 +--+9                                                    